function control_variables = control_input(u)
% u => ( state vector, reference x & derivatives, reference y &
% derivatives, k1, k2, k3, C_y, J, k4, k5)
% state vector => (x, y, v, theta, phi)
% reference x and derivatives => x_ref, x_ref_dot, x_ref_ddot, x_refd3dot
% reference y and derivatives => y_ref, y_ref_dot, y_ref_ddot, y_refd3dot

gains;
L_a = 1.5;
L_b = 1.5;

x = u(1);
y = u(2);
v = u(3);
theta = u(4);
phi = u(5);

x_ref = u(6);
x_ref_dot = u(7);
x_ref_ddot = u(8);
x_ref_d3dot = u(9);

y_ref = u(10);
y_ref_dot = u(11);
y_ref_ddot = u(12);
y_ref_d3dot = u(13);

m_J = u(14);
C_y = u(15);

alpha = (x_ref_ddot*(2*x_ref_dot - 2*k1*(x - x_ref)))/(2*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) - cos(theta)*(y - y_ref) - sin(theta)*(x - x_ref) - k3*(v - ((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + (y_ref_ddot*(2*y_ref_dot - 2*k2*(y - y_ref)))/(2*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + (k1*x_ref_dot*(x_ref_dot - k1*(x - x_ref)))/((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2) + (k2*y_ref_dot*(y_ref_dot - k2*(y - y_ref)))/((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2) - (k2*v*cos(theta)*(y_ref_dot - k2*(y - y_ref)))/((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2) - (k1*v*sin(theta)*(x_ref_dot - k1*(x - x_ref)))/((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2);
 
beta =  -(theta - atan((x_ref_dot - k1*(x - x_ref))/(y_ref_dot - k2*(y - y_ref))) + alpha*((k1*sin(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) - (k2*cos(theta)*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2)) + y_ref_ddot*(x_ref_ddot/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (k2*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (k4*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*y_ref_ddot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3) + ((x - x_ref)*(2*y_ref_dot - 2*k2*(y - y_ref)))/(2*((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + (k1*x_ref_dot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*x_ref_ddot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) + (2*y_ref_ddot*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) + ((x_ref_dot - k1*(x - x_ref))^2*(x - x_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^3) - ((x_ref_dot - k1*(x - x_ref))^3*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^4) - (2*k1*x_ref_dot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) + (2*k2*y_ref_dot*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) - (k1*v*sin(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + ((x_ref_dot - k1*(x - x_ref))*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k2*y_ref_dot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3) - (2*k2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) + (2*k1*v*sin(theta)*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) - ((x_ref_dot - k1*(x - x_ref))*(y - y_ref)*(2*y_ref_dot - 2*k2*(y - y_ref)))/(2*((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + (2*k2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3)) - x_ref_dot*(((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)/((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2) + (k1*k4)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) - (k1*y_ref_ddot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k1^2*x_ref_dot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + (2*k1*y_ref_ddot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) - (k1*(x_ref_dot - k1*(x - x_ref))*(x - x_ref))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) - (2*k1*x_ref_ddot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + (k1*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))) - (k1*k2*y_ref_dot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (2*k1^2*v*sin(theta)*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + (k1*(x_ref_dot - k1*(x - x_ref))*(x - x_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^2) + (k1*(x_ref_dot - k1*(x - x_ref))^2*(y - y_ref))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) - (k1*(x_ref_dot - k1*(x - x_ref))^2*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^3) + (2*k1*k2*y_ref_dot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) + (k1*k2*v*cos(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k1*k2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4)) + k5*(phi + k4*(theta - atan((x_ref_dot - k1*(x - x_ref))/(y_ref_dot - k2*(y - y_ref)))) - x_ref_ddot/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) + ((x - x_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2) + (y_ref_ddot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (k1*x_ref_dot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) + (k1*v*sin(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) - ((x_ref_dot - k1*(x - x_ref))*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))) + (k2*y_ref_dot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (k2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2)) + y_ref_dot*(((x_ref_dot - k1*(x - x_ref))*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))) + (k2*x_ref_ddot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k2*x_ref_ddot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) - (2*k2^2*y_ref_dot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3) + (2*k2*y_ref_ddot*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) - (k2*(x_ref_dot - k1*(x - x_ref))*(y - y_ref))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + (k2*(y_ref_dot - k2*(y - y_ref))*(x - x_ref))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + (2*k2^2*y_ref_dot*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) + (k2*k4*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k2*y_ref_ddot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3) + (k1*k2*x_ref_dot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (2*k2^2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3) + (k2*(x_ref_dot - k1*(x - x_ref))*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k2^2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) + (k2*(x_ref_dot - k1*(x - x_ref))^2*(x - x_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^3) - (k2*(x_ref_dot - k1*(x - x_ref))^3*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^4) - (2*k1*k2*x_ref_dot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) - (k1*k2*v*sin(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (2*k1*k2*v*sin(theta)*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4)) + phi*(k4 + (k1*v*cos(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) + (k2*v*sin(theta)*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2)) - x_ref_ddot*(k1/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) + k4/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) - y_ref_ddot/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - ((x - x_ref)*(2*x_ref_dot - 2*k1*(x - x_ref)))/(2*((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + ((y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))) - (k2*y_ref_dot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (x_ref_ddot*(2*x_ref_dot - 2*k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + (y_ref_ddot*(x_ref_dot - k1*(x - x_ref))*(2*x_ref_dot - 2*k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) + ((x - x_ref)*(2*x_ref_dot - 2*k1*(x - x_ref))*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(2*((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^2) - (k1*x_ref_dot*(2*x_ref_dot - 2*k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + (k2*v*cos(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (k1*v*sin(theta)*(2*x_ref_dot - 2*k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + ((x_ref_dot - k1*(x - x_ref))*(2*x_ref_dot - 2*k1*(x - x_ref))*(y - y_ref))/(2*((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) - ((x_ref_dot - k1*(x - x_ref))*(2*x_ref_dot - 2*k1*(x - x_ref))*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(2*((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^3) + (k2*y_ref_dot*(x_ref_dot - k1*(x - x_ref))*(2*x_ref_dot - 2*k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) - (k2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref))*(2*x_ref_dot - 2*k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4)) - x_ref_d3dot/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) + v*sin(theta)*(((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)/((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2) + (k1*k4)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))) - (k1*y_ref_ddot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k1^2*x_ref_dot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + (2*k1*y_ref_ddot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) - (k1*(x_ref_dot - k1*(x - x_ref))*(x - x_ref))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) - (2*k1*x_ref_ddot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + (k1*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))) - (k1*k2*y_ref_dot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (2*k1^2*v*sin(theta)*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^3) + (k1*(x_ref_dot - k1*(x - x_ref))*(x - x_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^2) + (k1*(x_ref_dot - k1*(x - x_ref))^2*(y - y_ref))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) - (k1*(x_ref_dot - k1*(x - x_ref))^2*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^3) + (2*k1*k2*y_ref_dot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) + (k1*k2*v*cos(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k1*k2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4)) - v*cos(theta)*(((x_ref_dot - k1*(x - x_ref))*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))) + (k2*x_ref_ddot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k2*x_ref_ddot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) - (2*k2^2*y_ref_dot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3) + (2*k2*y_ref_ddot*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) - (k2*(x_ref_dot - k1*(x - x_ref))*(y - y_ref))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + (k2*(y_ref_dot - k2*(y - y_ref))*(x - x_ref))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2)) + (2*k2^2*y_ref_dot*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) + (k2*k4*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k2*y_ref_ddot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3) + (k1*k2*x_ref_dot)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (2*k2^2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^3) + (k2*(x_ref_dot - k1*(x - x_ref))*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(1/2)*(y_ref_dot - k2*(y - y_ref))^2) - (2*k2^2*v*cos(theta)*(x_ref_dot - k1*(x - x_ref))^3)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^5) + (k2*(x_ref_dot - k1*(x - x_ref))^2*(x - x_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^3) - (k2*(x_ref_dot - k1*(x - x_ref))^3*(y - y_ref)*((x_ref_dot - k1*(x - x_ref))^2 + (y_ref_dot - k2*(y - y_ref))^2)^(1/2))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^(3/2)*(y_ref_dot - k2*(y - y_ref))^4) - (2*k1*k2*x_ref_dot*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4) - (k1*k2*v*sin(theta))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) + (2*k1*k2*v*sin(theta)*(x_ref_dot - k1*(x - x_ref))^2)/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)^2*(y_ref_dot - k2*(y - y_ref))^4)) + (y_ref_d3dot*(x_ref_dot - k1*(x - x_ref)))/(((x_ref_dot - k1*(x - x_ref))^2/(y_ref_dot - k2*(y - y_ref))^2 + 1)*(y_ref_dot - k2*(y - y_ref))^2) - (2*C_y*L_b^2*phi)/v)/(L_a*m_J);
 

control_variables(1) = alpha;
control_variables(2) = beta;
e1 = x - x_ref;
e2 = y - y_ref;
control_variables(3) = e1;
control_variables(4) = e2;

end